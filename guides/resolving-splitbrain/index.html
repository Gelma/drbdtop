<!DOCTYPE html>
<html lang="en-us">
    <head>
        

        <title>
            
            
                Resolving split-brains | drbdtop
            
        </title>

        <meta name="title" content="Resolving split-brains | drbdtop">

        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="referrer" content="no-referrer-when-downgrade">
        <meta name="generator" content="">
        <base href="https://linbit.github.io/drbdtop/">
        <meta name="description" content="Resolving split-brains in a few simple steps">
        
        <meta name="author" content="Hayley Swimelar and Roland Kammerer">
        
        <meta property="og:title" content="Resolving split-brains | drbdtop">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://linbit.github.io/drbdtop/">
        
        <meta name="og:description" content="Resolving split-brains in a few simple steps">
        

        

        <link rel="canonical" href="https://linbit.github.io/drbdtop/guides/resolving-splitbrain/">
        
        <link rel="stylesheet" href="styles/main.css" type="text/css">
        
        
        
    </head>

    <body>
        

        

        <nav class="row middle-xs center-xs">
            <div class="col-xs-6 col-sm-1 logo">
                <a href="https://linbit.github.io/drbdtop/"><img src="" alt="drbdtop"></a>
            </div>
            
            <div class="col-xs-3 col-md-2"><h3><a href="/drbdtop/guides/intro">About</a></h3></div>
            
            <div class="col-xs-3 col-md-2"><h3><a href="/drbdtop/guides">Guides</a></h3></div>
            
            <div class="col-xs-3 col-md-2"><h3><a href="https://github.com/linbit/drbdtop/releases/latest">Get</a></h3></div>
            
            <div class="col-xs-6 col-sm-1 nav-toggle">
                <a href="" class="nav-icon" onclick="return false"><img src="images/icon-menu.png" alt="Open Menu"><img src="images/icon-x.png" alt="Close Menu" style="display: none;"></a>
            </div>
        </nav>
        <section class="nav-full row middle-xs center-xs">
            <div class="col-xs-12">
                <div class="row middle-xs center-xs">
                    
                    <div class="col-xs-12"><h1><a href="/drbdtop/guides/intro">About</a></h1></div>
                    
                    <div class="col-xs-12"><h1><a href="/drbdtop/guides">Guides</a></h1></div>
                    
                    <div class="col-xs-12"><h1><a href="https://github.com/linbit/drbdtop/releases/latest">Get</a></h1></div>
                    
                </div>
            </div>
        </section>
        <main>


    <section class="container">
        <section class="content">
            <h1> Resolving split-brains </h1>

            <div class="sub-header">
                June 2017 Â· 2 minute read
            </div>

            <div class="entry-content">
                

<p>In this guide we describe how to resolve a <em>split-brain</em> situation in three steps. First of all you have to decide
which node(s) will be the split-brain <em>victim(s)</em> and which node will be the split-brain <em>survivor</em>. In this
guide we show these steps for a two-node cluster. We assume that <strong>drbdtop</strong> is started on all nodes and that
the resource to act on is selected.</p>

<h2 id="tl-tr">tl;tr</h2>

<ul>
<li>on all nodes: <code>'c'</code>,<code>'d'</code> (<strong>c</strong>onnection, <strong>d</strong>isconnect)</li>
<li>on the victim(s): <code>'c'</code>,<code>'m'</code> (<strong>c</strong>onnection, discard-<strong>m</strong>y-data)</li>
<li>on the survivor: <code>'c'</code>,<code>'c'</code> (<strong>c</strong>onnection, <strong>c</strong>onnect resource)</li>
<li>be happy ;-)</li>
</ul>

<h2 id="detailed-version">Detailed version</h2>

<p>In this section we present a step-by-step guide illustrated with screenshots.</p>

<h3 id="preparation">Preparation</h3>

<p>Select the resource on all nodes as depicted in the following screenshot:
<img src="screenshots/victim_select.png" alt="select" /></p>

<p>If nodes are <em>Standalone</em>, this step is not necessary, but it is easy enough to make sure that all connections
are disconnected: Press <code>'c'</code>, <code>'d'</code> (<strong>c</strong>onnection, <strong>d</strong>isconnect) on <strong>all</strong> nodes.</p>

<p>Press <code>'c'</code> on <strong>all</strong> nodes again so that they are in the <em>connection</em> menu:
<img src="screenshots/victim_c.png" alt="connect" /></p>

<h3 id="victims">Victims</h3>

<p>On the victim(s) press <code>'m'</code>, which issues a <code>drbdadm connect --discard-my-data foo</code>.</p>

<h3 id="survivor">Survivor</h3>

<p>On the survivor press <code>'c'</code>, which issues a <code>drbdadm connect foo</code>.</p>

<p>After these steps, the resource will start to synchronize and the data of the victim(s) gets overwritten
with the data of the survivor. Note that this does <strong>not</strong> imply a full synchronization and should finish
quickly (depending on the amount of data that diverged). You can of course monitor that progress in the
<em>in sync</em> view of <strong>drbdtop</strong>.</p>

<p>After the synchronization finished, the resource will be healthy again.
<img src="screenshots/victim_after.png" alt="healthy" /></p>

            </div>

            <div class="links">
                
                    &laquo; <a class="basic-alignment left" href="https://linbit.github.io/drbdtop/guides/intro/">What is drbdtop?</a>
                
                
            </div>
        </section>
        <br>
        <section class="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        (function() {
            
            
            if (window.location.hostname == "localhost")
                return;
            var disqus_shortname = '';
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view comments powered by <a href="http://disqus.com/?ref_noscript">Disqus</a>.</noscript>
</section>

    </section>

        </main>
        <footer class="row middle-xs center-xs">
            
            <div class="col-xs-3 col-md-2"><a href="https://github.com/linbit/drbdtop">GitHub</a></div>
            
            
            
            
            
            <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
            
            <script src="scripts/main.js" type="text/javascript"></script>
            
            <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
        </footer>
    </body>
</html>

